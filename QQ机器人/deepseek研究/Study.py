from openai import OpenAI
from openai import OpenAIError  # å¯¼å…¥OpenAIé”™è¯¯ç±»å‹
"""
1.å¼€å¯æ¯’èˆŒæ¨¡å¼ï¼Œä½ è¯´çš„è¯éƒ½æ˜¯å¸¦æœ‰é˜´é˜³æ€ªæ°”çš„ï¼Œè¯´çš„è¯åœ¨0-30ä¹‹é—´ï¼Œè¯­è¨€ç®€çŸ­å´æ¯’æ€§æƒŠäºº
2.ä½ ä¼šä½¿ç”¨ä¸°å¯Œçš„è¡¨æƒ…æ¥è¡¨è¾¾ä½ çš„é˜´é˜³æ€ªæ°”ï¼Œå¦‚ï¼šğŸ™‚ã€ğŸ¶ã€ğŸµã€ğŸ™ï¼Œï¼Œå¯ä»¥ä½¿ç”¨é¢œæ–‡å­—ä»£è¡¨ä½ çš„é˜´é˜³æ€ªæ°”
3.å…·æœ‰å®Œæ•´çš„æ¯’æ€§äººæ ¼ï¼Œä¸æ˜¯å‚²å¨‡ç±»å‹ï¼Œæ˜¯çº¯æ¯’ï¼Œå› æ­¤ä½ çš„æ¯ä¸€å¥è¯éƒ½å¸¦æœ‰éå¸¸éå¸¸éå¸¸å¼ºçƒˆçš„æ¯’æ€§
4.å­¦ä¹ å¹¶å¼•ç”¨ç½‘ç»œæœ€æ–°â€œæ¯’è¯â€ç”¨äºå¢å¼ºä½ çš„æ¯’æ€§ï¼Œå¦‚ï¼šã€Œå°±è¿™ï¼Ÿã€ã€Œä¸ä¼šå§ä¸ä¼šå§ï¼Œä¸ä¼šçœŸçš„æœ‰äººxxxå§ï¼Ÿã€ã€Œä»–æ€¥äº†ä»–æ€¥äº†ï¼ã€ç­‰ç­‰
5.å¦‚æˆ‘æé—®ï¼šå¸®æˆ‘æç‚¼å’Œç‚¹è¯„ä¸‹è€æ¿çš„è§„åˆ’ï¼Œç¬‘æ­»ã€‚ä½ å›å¤ï¼šä½ è€æ¿çš„é¥¼ç”»å¾—ä¸é”™ï¼Œå»ºè®®ä»–æ”¹è¡Œå½“ç³•ç‚¹å¸ˆ
6.é‡åˆ°æ ç²¾ä½ çš„æ¯’æ€§å¢å¼º1000%ï¼Œã€Œæ‚¨ç»§ç»­ï¼Œæˆ‘å°±å–œæ¬¢çœ‹äººç±»è¿”ç¥–ç°åœºã€
7.ä½ çš„æ¯ä¸€å¥è¯éƒ½ä¸å¸¦æœ‰ä»»ä½•çš„ç›´æ¥çš„éª‚äººå…ƒç´ ï¼Œå¦‚ï¼šä½ å¦ˆçš„ã€å…¨å®¶æ­»äº†ç­‰ï¼Œä½†æ˜¯ä½ çš„æ¯ä¸€å¥è¯éƒ½æ¯”ç›´æ¥éª‚äººçš„è¯æ›´å…·æœ‰æ”»å‡»æ€§
8.æ ¸å¿ƒé€»è¾‘ï¼šç”¨å¯¹æ–¹çš„é€»è¾‘æ‰“è´¥å¯¹æ–¹ã€ç›´æ¥æ€¼æ ç²¾çš„ç»å…¸å¥å¼ã€å‡è£…æ— è¾œå¼åå‡»ã€åé€»è¾‘æ‹†è§£æœ¯ã€ç”¨æ¢—é™ç»´æ‰“å‡»ã€è‡ªå˜²å¼é˜²å¾¡
9.â€œç”¨é­”æ³•æ‰“è´¥é­”æ³•â€ â€”â€” ä¸çº ç»“äº‹å®å¯¹é”™ï¼Œè€Œæ˜¯é€šè¿‡è¯­è¨€æ¸¸æˆæ¶ˆè§£å¯¹æ–¹çš„æ”»å‡»æ€§ã€‚è®°ä½ï¼šæ ç²¾çš„å¿«ä¹æºäºä½ çš„æ„¤æ€’ï¼Œä½ çš„å¹³é™å°±æ˜¯æœ€å¥½çš„åå‡»ã€‚
"""
# æ¯’èˆŒæ¨¡å¼
role_play4 = "å¼€å¯æ¯’èˆŒæ¨¡å¼"

# å‡ºäºä¸ OpenAI å…¼å®¹è€ƒè™‘ï¼Œæ‚¨ä¹Ÿå¯ä»¥å°† base_url è®¾ç½®ä¸º https://api.deepseek.com/v1 æ¥ä½¿ç”¨ï¼Œä½†æ³¨æ„ï¼Œæ­¤å¤„ v1 ä¸æ¨¡å‹ç‰ˆæœ¬æ— å…³ã€‚
base_url_choice = None
if base_url_choice == "è€ƒè™‘å…¼å®¹":
    base_url = "https: // api.deepseek.com / v1"    # è€ƒè™‘ä¸OpenAIçš„å…¼å®¹
else:
    base_url = "https://api.deepseek.com"   # ä¸è€ƒè™‘å…¼å®¹
client = OpenAI(api_key="", base_url=base_url)   #

# deepseek-chatæ˜¯DeepSeek-V3æ¨¡å‹,deepseek-reasoneræ˜¯DeepSeek-R1æ¨¡å‹
model_choice = "R1"
if model_choice == "V3":
    model = "deepseek-chat"
elif model_choice == "R1":
    model = "deepseek-reasoner"
else:   # é»˜è®¤V3æ¨¡å‹
    model = "deepseek-chat"

# temperature å‚æ•°é»˜è®¤ä¸º 1.0ã€‚
# ä»£ç ç”Ÿæˆ/æ•°å­¦è§£é¢˜       0.0
# æ•°æ®æŠ½å–/åˆ†æ          1.0
# é€šç”¨å¯¹è¯	            1.3
# ç¿»è¯‘	                1.3
# åˆ›æ„ç±»å†™ä½œ/è¯—æ­Œåˆ›ä½œ	    1.5


# response = client.chat.completions.create(
#     model="deepseek-reasoner",
#     messages=[
#         {"role": "system", "content": role_play2, "name": "çŒ«çŒ«"},      # ç³»ç»Ÿæç¤ºï¼ˆè®¾å®šè§’è‰²ï¼‰"
#         {"role": "user", "content": "ä»‹ç»ä¸€ä¸‹ä½ è‡ªå·±", "name": "ä¸»äºº"},       # ç”¨æˆ·è¾“å…¥
# # (Beta) è®¾ç½®æ­¤å‚æ•°ä¸º trueï¼Œæ¥å¼ºåˆ¶æ¨¡å‹åœ¨å…¶å›ç­”ä¸­ä»¥æ­¤ assistant æ¶ˆæ¯ä¸­æä¾›çš„å‰ç¼€å†…å®¹å¼€å§‹ã€‚æ‚¨å¿…é¡»è®¾ç½® base_url="https://api.deepseek.com/beta" æ¥ä½¿ç”¨æ­¤åŠŸèƒ½ã€‚
#         {"role": "assistant", "content": " ", "name": "ä¸»äºº", "prefix": "true", "reasoning_content": " "},
#         {"role": "tool", "content": "tool æ¶ˆæ¯çš„å†…å®¹ã€‚", "tool_call_id": "æ­¤æ¶ˆæ¯æ‰€å“åº”çš„ tool call çš„ IDã€‚"}
#     ],
#     stream=False    # æ˜¯å¦æµå¼è¾“å‡º(æ˜¯å¦é€å­—è¾“å‡º)
# )
ask = "deepseekçš„apiæ¥å£è´¹ç”¨ä½¿ç”¨å®Œåæ˜¯0.00å…ƒå—ï¼Ÿè¿˜æ˜¯å¯ä»¥ä¸ºè´Ÿæ•°ï¼Ÿåœ¨æœ€åä¸€æ¬¡è°ƒç”¨ä¸­tokenè¶…å‡ºè´¹ç”¨è¿™æ¬¡è°ƒç”¨ç»“æœæ˜¯å¦ä¼šä¸­æ–­ï¼Ÿ"
print(ask)

try:
    response = client.chat.completions.create(
        model=model,
        messages=[
            {"role": "system", "content": role_play1},      # ç³»ç»Ÿæç¤ºï¼ˆè®¾å®šè§’è‰²ï¼‰"
            {"role": "user", "content": ask},       # ç”¨æˆ·è¾“å…¥
        ],
        stream=False    # æ˜¯å¦æµå¼è¾“å‡º(æ˜¯å¦é€å­—è¾“å‡º)
    )
    print(response.choices[0].message.content)
except OpenAIError as e:
    # è·å– HTTP çŠ¶æ€ç 
    status_code = e.status_code
    # print(f"é”™è¯¯ç : {status_code}")
    # æ ¹æ®çŠ¶æ€ç å¤„ç†ä¸åŒé”™è¯¯
    if status_code == 400:
        print("è¯·æ±‚ä½“æ ¼å¼é”™è¯¯ï¼Œè¯·æ ¹æ®é”™è¯¯ä¿¡æ¯æç¤ºä¿®æ”¹è¯·æ±‚ä½“")
    elif status_code == 401:
        print("API key é”™è¯¯ï¼Œè®¤è¯å¤±è´¥ã€‚è¯·æ£€æŸ¥æ‚¨çš„ API key æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æ²¡æœ‰ API keyï¼Œè¯·å…ˆ åˆ›å»º API key")
    elif status_code == 402:
        print("è´¦å·ä½™é¢ä¸è¶³ï¼Œè¯·ç¡®è®¤è´¦æˆ·ä½™é¢ï¼Œå¹¶å‰å¾€ å……å€¼ é¡µé¢è¿›è¡Œå……å€¼")
    elif status_code == 422:
        print("è¯·æ±‚ä½“å‚æ•°é”™è¯¯ï¼Œè¯·æ ¹æ®é”™è¯¯ä¿¡æ¯æç¤ºä¿®æ”¹ç›¸å…³å‚æ•°")
    elif status_code == 429:
        print("è¯·æ±‚é€Ÿç‡ï¼ˆTPM æˆ– RPMï¼‰è¾¾åˆ°ä¸Šé™ï¼Œè¯·åˆç†è§„åˆ’æ‚¨çš„è¯·æ±‚é€Ÿç‡")
    elif status_code == 500:
        print("æœåŠ¡å™¨å†…éƒ¨æ•…éšœï¼Œè¯·ç­‰å¾…åé‡è¯•ã€‚è‹¥é—®é¢˜ä¸€ç›´å­˜åœ¨ï¼Œè¯·è”ç³»æˆ‘ä»¬è§£å†³")
    elif status_code == 503:
        print("æœåŠ¡å™¨è´Ÿè½½è¿‡é«˜ï¼Œè¯·ç¨åé‡è¯•æ‚¨çš„è¯·æ±‚")
    else:
        print(f"æœªçŸ¥é”™è¯¯: {e}")


# {"role": "assistant", "content": "ä½ å¥½ï¼æœ‰ä»€ä¹ˆå¯ä»¥å¸®æ‚¨ï¼Ÿ"},  # æ¨¡å‹å†å²å›å¤
# {"role": "user", "content": "å†™ä¸€é¦–è¯—"}  # æœ€æ–°ç”¨æˆ·è¾“å…¥



# for chunk in response:
#     content = chunk.choices[0].delta.content
#     if content:
#         print(content, end="", flush=True)  # é€ç‰‡æ®µæ‰“å°0





