**入门指南 - 库模式**  
**安装**  
**Pip方式**  
PyPI版本：

```bash
pip install --upgrade pip
pip install playwright
playwright install
```

**Conda方式**  
Anaconda版本：

```bash
conda config --add channels conda-forge
conda config --add channels microsoft
conda install playwright
playwright install
```

以上命令会下载Playwright包并安装Chromium、Firefox和WebKit的浏览器二进制文件。要修改此行为，请参阅[安装参数](https://playwright.dev/python/docs/browsers)。

**使用方法**  
安装完成后，可在Python脚本中导入Playwright，并启动三种浏览器（chromium、firefox和webkit）中的任意一种：

```python
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch()
    page = browser.new_page()
    page.goto("https://playwright.dev")
    print(page.title())
    browser.close()
```

Playwright支持同步和异步两种API变体。如果您的现代项目使用asyncio，应使用异步API：

```python
import asyncio
from playwright.async_api import async_playwright

async def main():
    async with async_playwright() as p:
        browser = await p.chromium.launch()
        page = await browser.new_page()
        await page.goto("https://playwright.dev")
        print(await page.title())
        await browser.close()

asyncio.run(main())
```

**第一个脚本**  
在第一个脚本中，我们将导航到 https://playwright.dev/ 并在WebKit中截图：

```python
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.webkit.launch()
    page = browser.new_page()
    page.goto("https://playwright.dev/")
    page.screenshot(path="example.png")
    browser.close()
```

默认情况下，Playwright以无头模式运行浏览器。要查看浏览器界面，请将`headless`选项设置为`False`。您还可以使用`slow_mo`来减慢执行速度。详见[调试工具](https://playwright.dev/python/docs/debug)部分：

```python
firefox.launch(headless=False, slow_mo=50)
```

**交互模式（REPL）**  
您可以启动交互式Python REPL：

```bash
python
```

然后在其中启动Playwright进行快速实验：

```python
from playwright.sync_api import sync_playwright
playwright = sync_playwright().start()
# 使用 playwright.chromium、playwright.firefox 或 playwright.webkit
# 向 launch() 传递 headless=False 以查看浏览器界面
browser = playwright.chromium.launch()
page = browser.new_page()
page.goto("https://playwright.dev/")
page.screenshot(path="example.png")
browser.close()
playwright.stop()
```

异步REPL（如asyncio REPL）：

```bash
python -m asyncio
```

```python
from playwright.async_api import async_playwright
playwright = await async_playwright().start()
browser = await playwright.chromium.launch()
page = await browser.new_page()
await page.goto("https://playwright.dev/")
await page.screenshot(path="example.png")
await browser.close()
await playwright.stop()
```

**Pyinstaller集成**  
您可以将Playwright与Pyinstaller结合使用来创建独立可执行文件：

**main.py**
```python
from playwright.sync_api import sync_playwright

with sync_playwright() as p:
    browser = p.chromium.launch()
    page = browser.new_page()
    page.goto("https://playwright.dev/")
    page.screenshot(path="example.png")
    browser.close()
```

如果希望将浏览器与可执行文件捆绑：

```bash
PLAYWRIGHT_BROWSERS_PATH=0 playwright install chromium
pyinstaller -F main.py
```

> **注意**：将浏览器与可执行文件捆绑会生成更大的二进制文件。建议仅捆绑您实际使用的浏览器。

**已知问题**  
**time.sleep()导致状态过时**  
您很可能不需要手动等待，因为Playwright具备自动等待机制。如果仍需依赖等待，应使用`page.wait_for_timeout(5000)`而非`time.sleep(5)`，最好完全不使用超时等待，但有时对调试有用。在这些情况下，请使用我们的等待方法（`wait_for_timeout`）代替time模块。这是因为我们内部依赖异步操作，使用`time.sleep(5)`时这些操作无法被正确处理。

**Windows上不兼容asyncio的SelectorEventLoop**  
Playwright在子进程中运行驱动程序，因此在Windows上需要asyncio的ProactorEventLoop，因为SelectorEventLoop不支持异步子进程。

在Windows Python 3.7上，Playwright将默认事件循环设置为ProactorEventLoop（Python 3.8+的默认设置）。

**多线程支持**  
Playwright的API不是线程安全的。如果在多线程环境中使用Playwright，应为每个线程创建独立的playwright实例。详见[多线程问题](https://github.com/microsoft/playwright-python/issues/439)获取更多细节。