# 校园考试系统项目结构分析

## 项目整体结构

```
exam/
├── .env/                          # Python虚拟环境配置目录
├── .idea/                         # PyCharm IDE配置文件
├── account/                       # 用户账户管理模块
│   ├── migrations/                # 数据库迁移文件
│   ├── admin.py                   # Django后台管理配置
│   ├── apps.py                    # 应用配置文件
│   ├── constants.py               # 常量定义文件
│   ├── email_notify.py            # 邮件通知功能
│   ├── email_service.py           # 邮件服务功能
│   ├── login_render.py            # 登录页面渲染
│   ├── login_views.py             # 登录相关视图
│   ├── models.py                  # 用户数据模型（用户信息、用户登记信息等）
│   ├── tests.py                   # 单元测试文件
│   ├── urls.py                    # 用户模块URL路由配置
│   └── views.py                   # 用户模块视图函数
├── api/                           # API接口模块
│   └── urls.py                    # API接口URL路由配置
├── backup/                        # 备份文件目录
├── business/                      # 机构/企业模块
│   ├── migrations/                # 数据库迁移文件
│   ├── admin.py                   # Django后台管理配置
│   ├── apps.py                    # 应用配置文件
│   ├── biz_render.py              # 机构页面渲染
│   ├── biz_views.py               # 机构相关视图
│   ├── models.py                  # 机构数据模型（出题账户、应用信息、配置信息等）
│   ├── tests.py                   # 单元测试文件
│   ├── urls.py                    # 机构模块URL路由配置
│   └── views.py                   # 机构模块视图函数
├── collect_static/                # 静态文件收集目录
├── competition/                   # 竞赛/考试模块
│   ├── migrations/                # 数据库迁移文件
│   ├── admin.py                   # Django后台管理配置
│   ├── apps.py                    # 应用配置文件
│   ├── cop_render.py              # 竞赛页面渲染
│   ├── game_views.py              # 游戏/竞赛相关视图
│   ├── models.py                  # 竞赛数据模型（比赛类别、题库、题目、答题记录等）
│   ├── rank_views.py              # 排行榜相关视图
│   ├── set_render.py              # 竞赛设置页面渲染
│   ├── set_views.py               # 竞赛设置相关视图
│   ├── tests.py                   # 单元测试文件
│   ├── urls.py                    # 竞赛模块URL路由配置
│   └── views.py                   # 竞赛模块视图函数
├── config/                        # 项目配置目录
│   ├── __init__.py                # 包初始化文件
│   ├── local_settings.py          # 本地开发环境配置（包含敏感信息）
│   ├── settings.py                # 项目主配置文件（数据库、中间件、应用配置等）
│   ├── urls.py                    # 项目根URL路由配置
│   └── wsgi.py                    # WSGI部署配置文件
├── redis/                         # Redis配置文件目录
├── utils/                         # 工具函数模块
│   ├── mysql/                     # MySQL数据库连接工具
│   ├── redis/                     # Redis连接和操作工具
│   ├── basemodels.py              # 基础模型类（包含创建更新时间戳、媒体资源等）
│   ├── check_utils.py             # 检查验证工具
│   ├── codegen.py                 # 代码生成工具
│   ├── decorators.py              # 装饰器工具
│   ├── errors.py                  # 错误定义
│   ├── jsonencoder.py             # JSON编码器
│   ├── processors.py              # 处理器（包含UserAgent检测中间件）
│   ├── response.py                # 响应处理工具
│   ├── small_utils.py             # 小工具函数
│   ├── upload_questions.py        # 上传题目工具
│   └── wechat_utils.py            # 微信工具函数
├── web/                           # 前端静态资源和模板目录
│   ├── static/                    # 静态资源文件
│   │   ├── css/                   # 样式文件
│   │   ├── js/                    # JavaScript脚本文件
│   │   └── web/                   # Web相关静态资源
│   └── templates/                 # HTML模板文件
│       ├── analysis/              # 分析页面模板
│       ├── bussiness/             # 机构页面模板
│       ├── competition/           # 竞赛页面模板
│       ├── emails/                # 邮件模板
│       ├── setgames/              # 游戏设置页面模板
│       ├── web/                   # 主页相关页面模板
│       ├── base.html              # 基础模板
│       ├── err.html               # 错误页面模板
│       └── err_new.html           # 新错误页面模板
├── LICENSE                        # 项目许可证文件
├── README.md                      # 项目说明文件
├── checkcodestyle.sh              # 代码风格检查脚本
├── manage.py                      # Django项目管理脚本
├── requirements.txt               # Python依赖包列表
└── tmp/                           # 临时文件目录
```

## 模块功能注释

### 1. account模块 - 用户账户管理
- **功能**：负责用户注册、登录、认证、个人信息管理
- **核心模型**：
  - Profile：用户基本信息模型，包括微信授权用户、普通用户、机构用户等不同来源的用户信息
  - UserInfo：用户登记信息模型，存储用户在比赛或活动中填写的表单信息
- **主要功能**：用户认证、邮箱通知、登录重定向、用户状态管理

### 2. business模块 - 机构管理
- **功能**：为机构用户提供出题、应用配置、题库管理等服务
- **核心模型**：
  - BusinessAccountInfo：出题账户信息模型
  - BusinessAppInfo：应用信息模型
  - AppConfigInfo：应用配置信息模型
- **主要功能**：机构账户管理、应用配置、用户表单字段配置、正则验证配置

### 3. competition模块 - 竞赛/考试管理
- **功能**：竞赛管理、题库管理、答题记录、排行榜等核心考试功能
- **核心模型**：
  - CompetitionKindInfo：比赛类别信息模型
  - BankInfo：题库信息模型
  - ChoiceInfo：选择题信息模型
  - FillInBlankInfo：填空题信息模型
  - CompetitionQAInfo：答题记录信息模型
- **主要功能**：竞赛管理、题库上传、答题功能、成绩统计、排行榜、搜索功能

### 4. config模块 - 项目配置
- **功能**：项目全局配置、数据库设置、中间件配置、URL路由入口
- **主要文件**：
  - settings.py：项目主配置文件，包含数据库、邮件、静态文件等配置
  - urls.py：项目根URL路由配置
- **主要功能**：项目配置管理、路由分发、中间件配置

### 5. utils模块 - 工具函数
- **功能**：提供各种通用工具函数和辅助类
- **主要功能**：
  - basemodels.py：基础模型类，包含时间戳、媒体资源等抽象模型
  - decorators.py：装饰器工具
  - processors.py：处理器工具，包含UserAgent检测中间件
  - Redis和MySQL连接工具：提供数据库连接功能

### 6. web模块 - 前端资源
- **功能**：包含静态资源和HTML模板
- **主要目录**：
  - static：CSS、JS、图片等静态资源
  - templates：HTML模板文件，按功能模块组织

## 代码关系分析

### 模块依赖关系

```
        config (核心配置)
           |
           v
    ┌──────┴──────┐
    |             |
account     competition
    |             |
    v             v
  business    (核心业务)
      |
      v
    utils (工具库)
```

### 详细依赖关系

1. **account模块**：
   - 依赖utils模块中的basemodels.py创建用户模型
   - 与competition模块交互，记录用户答题信息
   - 提供用户认证服务给其他模块

2. **business模块**：
   - 依赖utils模块中的基础模型
   - 与competition模块关联，管理竞赛和题库
   - 为机构用户提供出题和配置服务

3. **competition模块**：
   - 依赖account模块获取用户信息
   - 依赖business模块管理竞赛配置
   - 依赖utils模块中的基础模型和工具函数
   - 是项目的核心业务模块，处理所有竞赛相关功能

4. **utils模块**：
   - 作为基础工具库，被其他模块依赖
   - 提供基础模型、装饰器、数据库连接等通用功能

5. **config模块**：
   - 作为项目配置中心，被所有模块共享
   - 配置数据库、中间件、静态文件等全局设置
   - 定义URL路由入口，分发请求到各业务模块

### 项目技术栈
- **后端框架**：Django 2.1
- **数据库**：MySQL 5.7
- **缓存**：Redis
- **前端技术**：Bootstrap 3, CSS, JavaScript
- **编程语言**：Python 3.x
- **第三方库**：shortuuidfield, furl, Pillow, pymysql, TimeConvert, xlrd

### 项目业务流程
1. 用户通过account模块进行注册/登录
2. 机构用户通过business模块创建题库和竞赛配置
3. 用户参与competition模块中的竞赛，答题并查看结果和排行榜
4. 系统记录用户答题情况，计算成绩并生成排行榜

这个智慧校园考试系统是一个功能完整的在线考试平台，支持用户管理、机构出题、在线答题、成绩统计和排行榜等功能。